/* Copyright (c) Ericsson 2019 */

define("widgets/utils/keyboardUtils",[],function(){"use strict";var e={},t={BACKSPACE:8,TAB:9,ENTER:13,ESCAPE:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,ARROW_LEFT:37,ARROW_UP:38,ARROW_RIGHT:39,ARROW_DOWN:40,DELETE:46},i=function(t,i){var n,s=t.originalEvent.keyCode;if(Object.keys(i).some(function(t){if(e[t.toUpperCase()]===s)return n=i[t],!0}),n)return n(t)},n=function(e,t){if(!e||!t)throw new Error("Missing event argument");return e.addEventHandler("keydown",function(e){return i(e,t)})},s=function(e,t){t&&e.removeEventHandler(t)};return Object.keys(t).forEach(function(i){Object.defineProperty(e,i,{value:t[i],writable:!1})}),e.addKeyHandler=n,e.removeKeyHandler=s,e}),define("styles!widgets/Spinner/_spinner.less",function(){return".elWidgets-Spinner_compact .elWidgets-Spinner-downIconHolder,\n.elWidgets-Spinner_compact .elWidgets-Spinner-upIconHolder {\n  margin: 0;\n  height: 12px;\n}\n.elWidgets-Spinner_compact .elWidgets-Spinner-downIcon,\n.elWidgets-Spinner_compact .elWidgets-Spinner-upIcon {\n  height: 12px;\n  vertical-align: top;\n}\n"}),define("text!widgets/Spinner/_spinner.html",function(){return'<table class="ebSpinner">\n    <tr>\n        <td class="ebSpinner-label" style="display: none"></td>\n        <td class="ebSpinner-holder">\n            <div class="ebSpinner-up ebSpinner-iconUpHolder elWidgets-Spinner-upIconHolder">\n                <i class="ebIcon ebIcon_upArrow ebIcon_interactive elWidgets-Spinner-upIcon"></i>\n            </div>\n            <div class="ebSpinner-inputHolder">\n                <input type="text" class="ebInput ebInput_miniW ebInput_txtCenter eb_noMargin ebSpinner-input"\n                       value="20"/>\n            </div>\n            <div class="ebSpinner-down ebSpinner-iconDownHolder elWidgets-Spinner-downIconHolder">\n                <i class="ebIcon ebIcon_downArrow ebIcon_interactive elWidgets-Spinner-downIcon"></i>\n            </div>\n        </td>\n        <td class="ebSpinner-compactArrows" style="display: none"></td>\n        <td class="ebSpinner-value" style="display: none"></td>\n    </tr>\n</table>\n'}),define("widgets/Spinner/SpinnerView",["jscore/core","text!./_spinner.html","styles!./_spinner.less"],function(e,t,i){"use strict";return e.View.extend({getTemplate:function(){return t},getStyle:function(){return i},getPrefix:function(){return this.getElement().find(".ebSpinner-label")},getPostfix:function(){return this.getElement().find(".ebSpinner-value")},getUpButton:function(){return this.getElement().find(".ebSpinner-up")},getDownButton:function(){return this.getElement().find(".ebSpinner-down")},getInput:function(){return this.getElement().find(".ebSpinner-input")},getCompactArrows:function(){return this.getElement().find(".ebSpinner-compactArrows")}})}),define("widgets/Spinner/Spinner",["widgets/WidgetCore","./SpinnerView","widgets/utils/parserUtils","widgets/utils/keyboardUtils","jscore/ext/privateStore"],function(e,t,i,n,s){"use strict";function o(e,t){var i=void 0!==w(this).value&&w(this).value!==e;w(this).value=e,t!==!0&&i&&this.trigger("change",e)}function r(e,t){var i=Math.abs(t).toString(),n=0===t.toString().indexOf("-"),s=function(e,t){return 0===e?t:s(e-1,"0"+t)},o=i.length<e?s(e-i.length,i):i;return n?"-"+o:o}function l(e){var t=w(this).min,i=w(this).max;return void 0===i?e>=t:e<=i&&e>=t}function a(e){return e=e>w(this).max?w(this).max:e,e<w(this).min?w(this).min:e}function u(){this.view.getInput().getNative().select()}function d(e){e.originalEvent.keyCode===n.ARROW_UP&&f.call(this,w(this).step),e.originalEvent.keyCode===n.ARROW_DOWN&&f.call(this,-w(this).step);var t=e.originalEvent.which,i=e.originalEvent.keyCode,s=E.indexOf(i)!==-1,o=String.fromCharCode(t);(!s&&t<45||t>=112&&t<=123||e.originalEvent.ctrlKey)&&e.preventDefault();var r=/[0-9\-]/;s||r.test(o)||e.preventDefault()}function h(){var e=c.call(this);return g.call(this),isNaN(e)?void this.getElement().setModifier("status","error"):(l.call(this,e)?this.getElement().removeModifier("status"):(this.getElement().setModifier("status","error"),e=a.call(this,e)),void o.call(this,e))}function c(){var e=this.view.getInput().getValue();return""===e?void 0:i.parseInt(e)}function v(){this.getElement().removeModifier("status"),b.call(this)}function p(e){var t=w(this).value,i=t+e;if(l.call(this,i))return o.call(this,i),b.call(this),!0;if(i>w(this).max&&t<w(this).max)return o.call(this,w(this).max),b.call(this),!0;if(i<w(this).min&&t>w(this).min)return o.call(this,w(this).min),b.call(this),!0;if(w(this).overflow){if(i>w(this).max)return o.call(this,w(this).min),b.call(this),!0;if(i<w(this).min)return o.call(this,w(this).max),b.call(this),!0}return!1}function f(e){w(this).autoxcrementDelay=x,p.call(this,e),g.call(this),w(this).autoxcrementTimeout=setTimeout(function(){m.call(this,e)}.bind(this),w(this).autoxcrementDelay)}function m(e){clearTimeout(w(this).autoxcrementTimeout),p.call(this,e)&&(w(this).autoxcrementDelay>=S&&(w(this).autoxcrementDelay-=y),w(this).autoxcrementTimeout=setTimeout(m.bind(this,e),w(this).autoxcrementDelay))}function g(){w(this).autoxcrementTimeout&&(clearTimeout(w(this).autoxcrementTimeout),delete w(this).autoxcrementTimeout)}function b(){var e=this.options.minNumberDigitsFormat,t=this.view;if(t.getInput().setValue(void 0!==e?r(e,w(this).value):w(this).value),!w(this).overflow){var i=t.getUpButton().find(".ebIcon"),n=t.getDownButton().find(".ebIcon");l.call(this,w(this).value+w(this).step)||w(this).value<w(this).max?i.removeModifier("disabled"):i.setModifier("disabled"),l.call(this,w(this).value-w(this).step)||w(this).value>w(this).min?n.removeModifier("disabled"):n.setModifier("disabled")}}var E=[8,9,35,36,37,39,46,116],w=s.create(),S=100,x=400,y=50;return e.extend({View:t,init:function(e){this.options=e||{},w(this).min=void 0!==this.options.min?this.options.min:0,w(this).value=void 0!==this.options.value?this.options.value:w(this).min,w(this).max=void 0!==this.options.max?this.options.max:void 0,w(this).step=void 0!==this.options.step?this.options.step:1,w(this).overflow=void 0!==this.options.overflow&&void 0!==this.options.max&&this.options.overflow},onViewReady:function(){var e=this.options;if(e.compact){var t=this.view.getCompactArrows();this.getElement().setModifier("compact",void 0,"elWidgets-Spinner"),t.append(this.view.getUpButton()),t.append(this.view.getDownButton()),t.setStyle("display","table-cell")}this.enable(),this.setValue(w(this).value),this.setPrefix(e.prefix),this.setPostfix(e.postfix),this.setInputSize(e.inputSize||"miniW"),b.call(this),e.enabled===!1&&this.disable(),e.readonly===!0&&this.view.getInput().setAttribute("readonly",!0)},setPrefix:function(e){if(e&&""!==e.trim()){var t=this.view.getPrefix();t.setStyle("display","table-cell"),t.setText(e)}},setPostfix:function(e){if(e&&""!==e.trim()){var t=this.view.getPostfix();t.setStyle("display","table-cell"),t.setText(e)}},setValue:function(e){void 0===e||null===e||isNaN(e)||((e instanceof String||"string"==typeof e)&&(e instanceof String&&(e=e.toString()),e=""===e?0:i.parseInt(e)),o.call(this,a.call(this,e),!0),b.call(this))},getValue:function(){return w(this).value},setInputSize:function(e){["miniW","smallW","longW","xLongW"].indexOf(e)>-1&&(e=e.replace("W","")),this.view.getInput().setModifier("width",e)},enable:function(){if(!w(this).enabled){var e=this.view.getUpButton(),t=this.view.getDownButton(),i=this.view.getInput();w(this).upButtonMouseDownEvent=e.addEventHandler("mousedown",f.bind(this,w(this).step)),w(this).upButtonMouseUpEvent=e.addEventHandler("mouseup",g.bind(this)),w(this).upButtonMouseOutEvent=e.addEventHandler("mouseout",g.bind(this)),w(this).downButtonMouseDownEvent=t.addEventHandler("mousedown",f.bind(this,-w(this).step)),w(this).downButtonMouseUpEvent=t.addEventHandler("mouseup",g.bind(this)),w(this).downButtonMouseOutEvent=t.addEventHandler("mouseout",g.bind(this)),w(this).inputClickEvent=i.addEventHandler("click",u,this),w(this).inputKeyPressEvent=i.addEventHandler("keypress",d,this),w(this).inputKeyPressEvent=i.addEventHandler("keydown",function(e){e.originalEvent.keyCode!==n.ARROW_UP&&e.originalEvent.keyCode!==n.ARROW_DOWN||d.call(this,e)},this),w(this).inputKeyUpEvent=i.addEventHandler("keyup",h,this),w(this).inputBlurEvent=i.addEventHandler("blur",v,this),i.removeAttribute("disabled"),e.find(".ebIcon").removeModifier("disabled"),t.find(".ebIcon").removeModifier("disabled"),w(this).enabled=!0}},disable:function(){if(w(this).enabled){w(this).enabled=!1;var e=this.view.getUpButton(),t=this.view.getDownButton();e.removeEventHandler(w(this).upButtonMouseDownEvent),e.removeEventHandler(w(this).upButtonMouseUpEvent),e.removeEventHandler(w(this).upButtonMouseOutEvent),t.removeEventHandler(w(this).downButtonMouseDownEvent),t.removeEventHandler(w(this).downButtonMouseUpEvent),t.removeEventHandler(w(this).downButtonMouseOutEvent);var i=this.view.getInput();i.removeEventHandler(w(this).inputClickEvent),i.removeEventHandler(w(this).inputKeyPressEvent),i.removeEventHandler(w(this).inputKeyUpEvent),i.removeEventHandler(w(this).inputBlurEvent),i.setAttribute("disabled","disabled"),t.find(".ebIcon").setModifier("disabled"),e.find(".ebIcon").setModifier("disabled")}},restore:function(){var e=this.options.value;void 0!==e?this.setValue(e):this.setValue(w(this).min)}})}),define("widgets/Spinner",["widgets/Spinner/Spinner"],function(e){return e});