/* Copyright (c) Ericsson 2019 */

define("text!widgets/Accordion/_accordion.html",function(){return'<div class="ebAccordion">\n    <div class="ebAccordion-header" tabindex="0">\n        <div class="ebAccordion-button">\n            <i class="ebIcon ebIcon_small"></i>\n        </div>\n        <div class="ebAccordion-title"></div>\n    </div>\n\n    <div class="ebAccordion-body"></div>\n</div>\n'}),define("widgets/Accordion/AccordionView",["jscore/core","jscore/ext/privateStore","text!./_accordion.html"],function(t,e,i){"use strict";function n(){cancelAnimationFrame(d(this).foldAnimationFrame),cancelAnimationFrame(d(this).foldEndAnimationFrame),cancelAnimationFrame(d(this).expandAnimationFrame),clearTimeout(d(this).expandEndTimer),delete d(this).foldAnimationFrame,delete d(this).foldEndAnimationFrame,delete d(this).expandAnimationFrame}function o(t){var e="expanded"===t,i=this.getIcon();i.removeModifier(e?"downArrow":"upArrow"),i.setModifier(e?"upArrow":"downArrow","10px")}var d=e.create(),r="ebAccordion",s="."+r;return t.View.extend({getTemplate:function(){return i},getHeader:function(){return this.getElement().find(s+"-header")},getButton:function(){return this.getElement().find(s+"-button")},getIcon:function(){return this.getElement().find(".ebIcon")},getTitle:function(){return this.getElement().find(s+"-title")},getContent:function(){return this.getElement().find(s+"-body")},expandContent:function(t){o.call(this,"expanded"),this.adjustContentHeight(t)},foldContent:function(t){var e=this.getContent();o.call(this,"collapsed"),t===!0?e.setStyle("max-height",0):(n.call(this),d(this).foldAnimationFrame=requestAnimationFrame(function(){var t=e.children()[0].getProperty("clientHeight");e.setStyle("max-height",t+"px"),d(this).foldEndAnimationFrame=requestAnimationFrame(function(){e.setStyle("max-height",0)}.bind(this)),delete d(this).foldAnimationFrame}.bind(this)))},adjustContentHeight:function(t){var e=this.getContent();t&&t.preventAnimate===!0?e.setStyle("max-height","inherit"):(n.call(this),d(this).expandAnimationFrame=requestAnimationFrame(function(){var t=this.getContent(),e=t.children()[0].getProperty("clientHeight"),i=function(){t.setStyle("max-height","inherit"),clearTimeout(d(this).expandEndTimer)};d(this).expandEndTimer=setTimeout(i.bind(this),500),t.setStyle("max-height",e+"px"),delete d(this).expandAnimationFrame}.bind(this)))}})}),define("widgets/utils/keyboardUtils",[],function(){"use strict";var t={},e={BACKSPACE:8,TAB:9,ENTER:13,ESCAPE:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,ARROW_LEFT:37,ARROW_UP:38,ARROW_RIGHT:39,ARROW_DOWN:40,DELETE:46},i=function(e,i){var n,o=e.originalEvent.keyCode;if(Object.keys(i).some(function(e){if(t[e.toUpperCase()]===o)return n=i[e],!0}),n)return n(e)},n=function(t,e){if(!t||!e)throw new Error("Missing event argument");return t.addEventHandler("keydown",function(t){return i(t,e)})},o=function(t,e){e&&t.removeEventHandler(e)};return Object.keys(e).forEach(function(i){Object.defineProperty(t,i,{value:e[i],writable:!1})}),t.addKeyHandler=n,t.removeKeyHandler=o,t}),define("widgets/Accordion/Accordion",["jscore/core","jscore/ext/privateStore","widgets/WidgetCore","widgets/utils/keyboardUtils","./AccordionView"],function(t,e,i,n,o){"use strict";function d(t){l(this).enabled=!1,this.getElement().setModifier("disabled"),this.isEmpty()||this.view.foldContent(t)}function r(){this.isEnabled()&&(this.isExpanded()?this.trigger("collapse"):(this.trigger("beforeExpand"),this.trigger("expand")))}function s(t){t.originalEvent.keyCode===n.ENTER&&this.trigger("click")}function a(t){this.isEnabled()&&!this.isExpanded()&&(this.view.expandContent(t),l(this).expanded=!0)}function c(){this.isExpanded()&&(this.view.foldContent(),l(this).expanded=!1)}function h(t){return"string"==typeof t||t instanceof String}var l=e.create();return i.extend({View:o,init:function(){l(this)._expanded=!1},onViewReady:function(){this.setTitle(this.options.title||"Accordion Header"),this.setContent(this.options.content),this.options.enabled===!1&&d.call(this,!0),"function"==typeof this.options.beforeExpand&&this.addEventHandler("beforeExpand",this.options.beforeExpand),this.view.getHeader().addEventHandler("keypress",s.bind(this)),this.addEventHandler("expand",a.bind(this)),this.addEventHandler("collapse",c.bind(this)),this.addEventHandler("click",r.bind(this)),this.options.expanded===!0?a.call(this,{preventAnimate:!0}):this.view.getIcon().setModifier("downArrow","10px")},setTitle:function(e){void 0!==l(this).headerClickEventId&&(l(this).headerClickEventId.destroy(),l(this).headerClickEventId=void 0),void 0!==l(this).buttonClickEventId&&(l(this).buttonClickEventId.destroy(),l(this).buttonClickEventId=void 0);var i=this.view.getTitle(),n=this.view.getButton(),o=this.view.getHeader(),d=function(){this.trigger("click")};if(h(e))i.setText(e),o.removeModifier("noAction"),l(this).headerClickEventId=o.addEventHandler("click",d.bind(this));else{if(!(e instanceof t.Widget))throw new Error("Title for Accordion should be core.Widget or string.");i.setText(""),l(this).buttonClickEventId=n.addEventHandler("click",d.bind(this)),o.setModifier("noAction"),e.attachTo(i)}},setContent:function(e){var i=this.view.getContent();if(i.children().forEach(function(t){t.remove()}),e)if(h(e)){var n=new t.Widget;n.getElement().setText(e),e=n}else if(!(e instanceof t.Widget||e instanceof t.Region))throw new Error("Content for Accordion should be Widget/String/Region.");l(this).content=e?e:void 0,void 0!==l(this).content&&(l(this).content instanceof t.Region?l(this).content.isRunning()?l(this).content.attach(i):l(this).content.start(i):l(this).content.attachTo(i)),l(this).expanded===!0&&this.view.adjustContentHeight(),e||this.disable(),(this.options.enabled===!0||e)&&this.enable()},enable:function(){l(this).enabled=!0,this.getElement().removeModifier("disabled")},disable:function(){d.call(this)},isEmpty:function(){return void 0===l(this).content},isEnabled:function(){return l(this).enabled===!0},isExpanded:function(){return l(this).expanded===!0}})}),define("widgets/Accordion",["widgets/Accordion/Accordion"],function(t){return t});