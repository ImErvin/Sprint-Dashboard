/* Copyright (c) Ericsson 2019 */

define("widgets/utils/keyboardUtils",[],function(){"use strict";var t={},e={BACKSPACE:8,TAB:9,ENTER:13,ESCAPE:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,ARROW_LEFT:37,ARROW_UP:38,ARROW_RIGHT:39,ARROW_DOWN:40,DELETE:46},n=function(e,n){var i,o=e.originalEvent.keyCode;if(Object.keys(n).some(function(e){if(t[e.toUpperCase()]===o)return i=n[e],!0}),i)return i(e)},i=function(t,e){if(!t||!e)throw new Error("Missing event argument");return t.addEventHandler("keydown",function(t){return n(t,e)})},o=function(t,e){e&&t.removeEventHandler(e)};return Object.keys(e).forEach(function(n){Object.defineProperty(t,n,{value:e[n],writable:!1})}),t.addKeyHandler=i,t.removeKeyHandler=o,t}),define("template!widgets/Dialog/_dialog.hbs",["jscore/handlebars/handlebars"],function(t){return t.template(function(t,e,n,i,o){function r(t,e){return'\n            <div class="ebDialogBox-icon">\n                <span class="ebDialog-topRightButton ebIcon ebIcon_close ebIcon_interactive" tabindex=\'0\'></span>\n            </div>\n            '}function s(t,e){return'\n                    <div class="ebDialogBox-primaryText"></div>\n                    <div class="ebDialogBox-secondaryText"></div>\n                    <div class="ebDialogBox-thirdText"></div>\n                    '}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,t.helpers);var a,c="",h=this;return c+='<div class="ebDialog">\n    <div class="ebDialog-holder">\n        <div class="ebDialogBox">\n            ',a=n.if.call(e,e&&e.topRightCloseBtn,{hash:{},inverse:h.noop,fn:h.program(1,r,o)}),(a||0===a)&&(c+=a),c+='\n            <div class="ebDialogBox-contentBlock">\n                <div class="ebDialogBox-content eb_scrollbar">\n                    ',a=n.unless.call(e,e&&e.fullContent,{hash:{},inverse:h.noop,fn:h.program(3,s,o)}),(a||0===a)&&(c+=a),c+='\n                </div>\n            </div>\n            <div class="ebDialogBox-actionBlock">\n                <button class="ebBtn ebBtn_color_darkBlue ebDialog-primaryActionButton"></button>\n                <button class="ebBtn ebDialog-secondaryActionButton"></button>\n                <button class="ebBtn ebDialog-thirdActionButton"></button>\n            </div>\n        </div>\n    </div>\n</div>\n'})}),define("widgets/Dialog/DialogView",["jscore/core","template!./_dialog.hbs"],function(t,e){"use strict";var n=t.View.extend({afterRender:function(){var t=this.getElement();this.contentBlock=t.find("."+n.EL_CONTENT_BLOCK),this.header=t.find("."+n.EL_HEADER),this.content=t.find("."+n.EL_CONTENT),this.contentWrapper=t.find("."+n.EL_CONTENT_WRAPPER),this.optionalContent=t.find("."+n.EL_OPTIONAL_CONTENT),this.actionBlock=t.find("."+n.EL_ACTION_BLOCK),this.primaryBtn=t.find("."+n.EL_PRIMARY_BTN),this.secondaryBtn=t.find("."+n.EL_SECONDARY_BTN),this.thirdBtn=t.find("."+n.EL_THIRD_BTN),this.topRightBtn=t.find("."+n.EL_TOP_RIGHT_BTN),this.dialogBox=t.find("."+n.EL_DIALOG_BOX),this.dialogBoxIcon=t.find("."+n.EL_DIALOG_BOX_ICON)},getTemplate:function(){return e(this.options)},getRoot:function(){return this.getElement()},getContentBlock:function(){return this.contentBlock},getContentWrapper:function(){return this.contentWrapper},getHeader:function(){return this.header},getContent:function(){return this.content},getOptionalContent:function(){return this.optionalContent},getActionBlock:function(){return this.actionBlock},getPrimaryButton:function(){return this.primaryBtn},getSecondaryButton:function(){return this.secondaryBtn},getThirdButton:function(){return this.thirdBtn},getTopRightCloseBtn:function(){return this.topRightBtn},getDialogBox:function(){return this.dialogBox},getDialogBoxIcon:function(){return this.dialogBoxIcon}},{EL_CONTENT_BLOCK:"ebDialogBox-contentBlock",EL_HEADER:"ebDialogBox-primaryText",EL_CONTENT:"ebDialogBox-secondaryText",EL_CONTENT_WRAPPER:"ebDialogBox-content",EL_OPTIONAL_CONTENT:"ebDialogBox-thirdText",EL_ACTION_BLOCK:"ebDialogBox-actionBlock",EL_PRIMARY_BTN:"ebDialog-primaryActionButton",EL_SECONDARY_BTN:"ebDialog-secondaryActionButton",EL_THIRD_BTN:"ebDialog-thirdActionButton",EL_TOP_RIGHT_BTN:"ebDialog-topRightButton",EL_DIALOG_BOX:"ebDialogBox",EL_DIALOG_BOX_ICON:"ebDialogBox-icon"});return n}),define("widgets/Dialog/Dialog",["jscore/core","jscore/ext/privateStore","widgets/WidgetCore","./DialogView","widgets/Button","widgets/utils/keyboardUtils","widgets/utils/parserUtils","widgets/utils/domUtils"],function(t,e,n,i,o,r,s,a){"use strict";function c(){g(this)._windowEvtId||(g(this)._windowEvtId=t.Window.addEventHandler("hashchange",this.hide.bind(this)))}function h(){function e(){var n=c.getProperty("offsetHeight"),d=h.getProperty("offsetHeight"),l={width:t.Window.getProperty("innerWidth"),height:t.Window.getProperty("innerHeight")},u=d;u+=l.width<=480?o:l.width<992?r:s,a.isTouchZoomActive()||a.isTouchKeyboardOpen()||(!g(this).hasForcedOverflow&&u>l.height?(i.setStyle({height:"100%"}),g(this).hasForcedOverflow=!0):d+2<n&&(i.removeStyle("height"),g(this).hasForcedOverflow=!1)),g(this)._nextFrame=requestAnimationFrame(e.bind(this))}var n=this.view,i=n.getDialogBox(),o=81,r=136,s=186,c=n.getContentBlock(),h=n.getContentWrapper();g(this)._nextFrame=requestAnimationFrame(e.bind(this))}function d(){cancelAnimationFrame(g(this)._nextFrame)}function l(){g(this)._windowEvtId&&(t.Window.removeEventHandler(g(this)._windowEvtId),delete g(this)._windowEvtId)}function u(t){g(this).visible&&t.originalEvent.keyCode===r.ESCAPE&&this.hide(),t.stopPropagation()}var g=e.create();return n.extend({view:function(){return new i(this.options)},onViewReady:function(){var e=this.options,n=this.getElement();e.closable===!0&&n.addEventHandler("click",function(t){t.originalEvent.target===this.getElement().getNative()&&this.hide()}.bind(this)),e.fullContent!==!0&&(this.setHeader(e.header||"Header"),this.setOptionalContent(e.optionalContent)),this.setContent(e.content||"Content");var i=this.view;if(e.buttons?(i.getPrimaryButton().remove(),i.getSecondaryButton().remove(),i.getThirdButton().remove(),this.setButtons(e.buttons||[{name:"Close",action:function(){this.hide()}.bind(this)}])):(this.setPrimaryButtonCaption(e.primaryButtonCaption||"Save"),this.setSecondaryButtonCaption(e.secondaryButtonCaption||"Cancel"),this.setThirdButtonCaption(e.thirdButtonCaption||"Other")),this.setDialogType(e.type||"default"),e.showPrimaryButton===!1&&this.hidePrimaryButton(),void 0!==e.showThirdButton&&e.showThirdButton!==!1||this.hideThirdButton(),g(this).visible=!1,e.visible===!0&&this.show(),e.topRightCloseBtn===!0){var o=i.getTopRightCloseBtn();o.addEventHandler("click",function(){this.hide()},this),o.addEventHandler("keyup",function(t){g(this).visible&&t.originalEvent.keyCode===r.ENTER&&this.hide(),t.stopPropagation()}.bind(this)),i.getDialogBox().addEventHandler("keydown",u.bind(this))}c.call(this);var s=i.getContentWrapper();n.addEventHandler("touchmove",function(e){var n=e.originalEvent.target;n===s.getNative()||s.contains(t.Element.wrap(n))||e.preventDefault()})},onDestroy:function(){l.call(this),d.call(this),t.Window.__releaseFocusLock()},setHeader:function(t){this.view.getHeader().setText(t)},setContent:function(e){if(!("string"==typeof e||e instanceof t.Widget||e instanceof t.Element||e instanceof t.Region))throw new Error("Content for Dialog should be Widget, String or Region!");var n=this.options.fullContent!==!0?this.view.getContent():this.view.getContentWrapper();if(n.children().forEach(function(t){t.detach()}),n.setText(""),"string"==typeof e||e instanceof t.Element){var i=e;"string"==typeof e&&(i=new t.Element("p"),i.setProperty("innerHTML",s.parseLinks(s.stripTags(e)))),n.append(i)}else e instanceof t.Region?e.isRunning()?e.attach(n):e.start(n):e.attachTo(n)},setOptionalContent:function(e){var n=this.view.getOptionalContent();if(void 0===e)return void n.detach();if(!("string"==typeof e||e instanceof t.Widget||e instanceof t.Region))throw new Error("Content for Dialog should be Widget, String or Region!");if(n.children().forEach(function(t){t.detach()}),n.setText(""),"string"==typeof e){var i=new t.Element("p");i.setProperty("innerHTML",s.parseLinks(s.stripTags(e))),n.append(i)}else e instanceof t.Region?e.isRunning()?e.attach(n):e.start(n):e.attachTo(n)},setButtons:function(t){if(!Array.isArray(t))throw new Error("Expected arguement of type Array but got type: "+typeof t);var e=this.view.getActionBlock();if(e.children().forEach(function(t){t.detach()}),g(this).buttons&&g(this).buttons.forEach(function(t){t.destroy()}),0!==t.length){var n=t[0];n.color||(n.color="darkBlue"),g(this).buttons=[],t.forEach(function(t){var e=new o({caption:t.caption,enabled:t.enabled,modifiers:[]});t.color&&e.setModifier("color",t.color),e.addEventHandler("click",t.action),e.attachTo(this.view.getActionBlock()),g(this).buttons.push(e)}.bind(this))}},getButtons:function(){return g(this).buttons},setDialogType:function(t){var e=["warning","error","confirmation","information"],n=this.view.getContentBlock();e.indexOf(t)!==-1?n.setModifier("type",t):n.removeModifier("type")},show:function(){g(this).visible=!0,c.call(this),h.call(this);var e=t.Element.wrap(document.body);e.append(this.getElement()),t.Window.__requestFocusLock(this.getElement());var n=this.options.buttons;n&&n.forEach(function(t,e){t.focused&&g(this).buttons[e].getElement().focus()}.bind(this))},hide:function(){this.isVisible()&&(g(this).visible=!1,this.getElement().detach(),l.call(this),d.call(this),t.Window.__releaseFocusLock(),this.trigger("hide"))},isVisible:function(){return g(this).visible},setPrimaryButtonCaption:function(t){this.getPrimaryButton().setText(t)},setSecondaryButtonCaption:function(t){this.getSecondaryButton().setText(t)},setThirdButtonCaption:function(t){this.getThirdButton().setText(t)},hidePrimaryButton:function(){this.getPrimaryButton().detach()},hideSecondaryButton:function(){this.getSecondaryButton().detach()},hideThirdButton:function(){this.getThirdButton().detach()},showPrimaryButton:function(){this.getPrimaryButton().detach(),this.getSecondaryButton().detach(),this.getThirdButton().detach();var t=this.view.getActionBlock();t.append(this.getPrimaryButton()),t.append(this.getSecondaryButton()),t.append(this.getThirdButton())},getPrimaryButton:function(){return this.view.getPrimaryButton()},getSecondaryButton:function(){return this.view.getSecondaryButton()},getThirdButton:function(){return this.view.getThirdButton()}})}),define("widgets/Dialog",["widgets/Dialog/Dialog"],function(t){return t});