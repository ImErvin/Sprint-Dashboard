/* Copyright (c) Ericsson 2019 */

define("text!widgets/Combobox/_combobox.html",function(){return'<div class="ebCombobox">\n    <input type="text" class="ebInput ebInput_noRightSide"/>\n    <button type="button" class="ebCombobox-helper">\n        <span class="ebCombobox-iconHolder">\n            <i class="ebIcon ebIcon_small ebIcon_downArrow_10px eb_noVertAlign"></i>\n        </span>\n    </button>\n</div>'}),define("widgets/Combobox/ComboboxView",["jscore/core","text!./_combobox.html"],function(e,t){"use strict";var i=e.View.extend({afterRender:function(){this.input=this.getElement().find("."+i.EL_INPUT),this.helper=this.getElement().find("."+i.EL_HELPER)},getTemplate:function(){return t},getRoot:function(){return this.getElement()},getInput:function(){return this.input},getHelper:function(){return this.helper}},{EL_INPUT:"ebInput",EL_HELPER:"ebCombobox-helper"});return i}),define("widgets/utils/AutoCompleteWidget",["widgets/ItemsControl"],function(e){"use strict";function t(){var e=this.getFocusableElement().getValue(),t=i(e);e!==t&&this.getFocusableElement().setValue(t),this.autoComplete&&this.autoComplete.caseInsensitive&&(t=t.toLowerCase());var n=this.setFilter(function(e){return this.autoComplete&&this.autoComplete.caseInsensitive?e._lowerCaseName&&e._lowerCaseName.indexOf(t)!==-1||e._lowerCaseTitle&&e._lowerCaseTitle.indexOf(t)!==-1:e.name&&e.name.indexOf(t)!==-1||e.title&&e.title.indexOf(t)!==-1}.bind(this));0===n.length?this.autoComplete.message.notFound?(this.showMessageInfo(this.autoComplete.message.notFound),this.showList()):this.hideList():(this.hideMessageInfo(),this.showList())}function i(e){return e.replace(/\r?\n/g,"")}return e.extend({onViewReady:function(){var t=this.options.autoComplete||{};this.autoComplete={enabled:void 0===t.enabled||t.enabled,message:t.message||{},caseInsensitive:t.caseInsensitive},e.prototype.onViewReady.call(this),this.options.bindClick!==!1&&this.getElement().addEventHandler("click",function(){this.setFilter(function(){return!0})}.bind(this))},setItems:function(t){this.allItems=t;var i=function(e){e.name&&(e._lowerCaseName=e.name.toLowerCase()),e.title&&(e._lowerCaseTitle=e.title.toLowerCase())};this.autoComplete&&this.autoComplete.caseInsensitive&&this.allItems.forEach(function(e){e.items?e.items.forEach(function(e){i(e)}):i(e)}),e.prototype.setItems.apply(this,arguments)},enable:function(){void 0===this._acInputEvtId&&this.autoComplete.enabled===!0&&this.options.bindClick!==!1&&(this._acInputEvtId=this.getFocusableElement().addEventHandler("input",t,this)),e.prototype.enable.call(this)},disable:function(){this._acInputEvtId&&(this.getFocusableElement().removeEventHandler(this._acInputEvtId),delete this._acInputEvtId),e.prototype.disable.call(this)},setOption:function(t,i){this.options[t]=i,e.prototype.setOption.call(this,t,i)}})}),define("widgets/Combobox/Combobox",["../utils/AutoCompleteWidget","./ComboboxView","jscore/ext/privateStore","jscore/core"],function(e,t,i,n){"use strict";var s=i.create();return e.extend({View:t,onInit:function(){s(this).lastChangeEventValue={},s(this).touch=n.Window.isTouch&&n.Window.isTouch(),s(this).touch&&(this.setOption("showAsDialog",!0),this.setOption("bindClick",!1))},onControlReady:function(){this.setValue(this.options.value||{}),this.setPlaceholder(this.options.placeholder||""),this.getElement().addEventHandler("change",this.triggerChangeEvent.bind(this)),this.getElement().addEventHandler("input",function(){s(this).inputEventTriggered=!0}.bind(this)),s(this).touch&&this.view.getHelper().addEventHandler("click",this.showList.bind(this))},setItems:function(t){e.prototype.setItems.call(this,t),s(this).items=t},setValue:function(e){var t="";""===e||void 0===e?s(this).lastChangeEventValue={}:"object"==typeof e&&(t=e.name,void 0===t&&(s(this).lastChangeEventValue={})),this.view.getInput().setValue(t)},getValue:function(){for(var e=this.view.getInput().getValue(),t=0;t<s(this).items.length;t++){var i=s(this).items[t];if(i.name===e||i.value===e)return i}return{name:e,value:e}},setPlaceholder:function(e){this.view.getInput().setAttribute("placeholder",e)},setInputSize:function(e){["miniW","smallW","longW","xLongW"].indexOf(e)>-1&&(e=e.replace("W",""));var t=["mini","small","long","xLong","full"];t.indexOf(e)!==-1?(this.view.getInput().setModifier("width",e),"full"===e&&this.getElement().setModifier("width","full"),s(this).currentInputSize=e):this.currentInputSize&&(this.view.getInput().removeModifier("width"),this.getElement().removeModifier("width"),s(this).currentInputSize="")},onEnable:function(){var e=this.view;e.getInput().removeAttribute("disabled"),e.getHelper().removeAttribute("disabled")},onDisable:function(){var e=this.view;e.getInput().setAttribute("disabled","disabled"),e.getHelper().setAttribute("disabled","disabled")},onItemSelected:function(e){this.setValue(e),this.triggerChangeEvent()},triggerChangeEvent:function(){s(this).changeTriggered||(s(this).changeTriggered=requestAnimationFrame(function(){requestAnimationFrame(function(){var e=this.getValue();(s(this).inputEventTriggered||s(this).lastChangeEventValue!==e)&&(this.trigger("change"),s(this).lastChangeEventValue=e,s(this).inputEventTriggered=!1),delete s(this).changeTriggered}.bind(this))}.bind(this)))},getFocusableElement:function(){return this.view.getInput()},reset:function(){this.setValue({}),s(this).lastChangeEventValue={}},restore:function(){var e=this.options.value;e?this.setValue(e):this.reset()}})}),define("widgets/Combobox",["widgets/Combobox/Combobox"],function(e){return e});