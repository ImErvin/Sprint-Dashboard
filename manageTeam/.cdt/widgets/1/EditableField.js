/* Copyright (c) Ericsson 2019 */

define("widgets/utils/keyboardUtils",[],function(){"use strict";var e={},t={BACKSPACE:8,TAB:9,ENTER:13,ESCAPE:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,ARROW_LEFT:37,ARROW_UP:38,ARROW_RIGHT:39,ARROW_DOWN:40,DELETE:46},i=function(t,i){var l,n=t.originalEvent.keyCode;if(Object.keys(i).some(function(t){if(e[t.toUpperCase()]===n)return l=i[t],!0}),l)return l(t)},l=function(e,t){if(!e||!t)throw new Error("Missing event argument");return e.addEventHandler("keydown",function(e){return i(e,t)})},n=function(e,t){t&&e.removeEventHandler(t)};return Object.keys(t).forEach(function(i){Object.defineProperty(e,i,{value:t[i],writable:!1})}),e.addKeyHandler=l,e.removeKeyHandler=n,e}),define("styles!widgets/EditableField/input/_input.less",function(){return".elWidgets-EditableField-Input {\n  display: none;\n  position: absolute;\n  bottom: 0;\n  left: 0;\n  top: 0;\n  max-width: 100%;\n}\n.elWidgets-EditableField-Input-Textbox {\n  font-size: inherit;\n  padding-right: 0;\n  padding-left: 2px;\n  max-width: 100%;\n}\n.elWidgets-EditableField-Input-Textbox_error:focus {\n  box-shadow: 0 0 1px 1px #e32119;\n}\n.elWidgets-EditableField_editMode .elWidgets-EditableField-Input,\n.elWidgets-EditableField_status_error .elWidgets-EditableField-Input {\n  display: block;\n}\n"}),define("template!widgets/EditableField/input/_input.hbs",["jscore/handlebars/handlebars"],function(e){return e.template(function(e,t,i,l,n){this.compilerInfo=[4,">= 1.0.0"],i=this.merge(i,e.helpers);var d,a,o="",s="function",r=this.escapeExpression;return o+='<div class="elWidgets-EditableField-Input">\n\t<input type="text" class="elWidgets-EditableField-Input-Textbox ebInput" placeholder="',(a=i.placeholder)?d=a.call(t,{hash:{}}):(a=t&&t.placeholder,d=typeof a===s?a.call(t,{hash:{}}):a),o+=r(d)+'" value="',(a=i.value)?d=a.call(t,{hash:{}}):(a=t&&t.value,d=typeof a===s?a.call(t,{hash:{}}):a),o+=r(d)+'" />\n</div>\n'})}),define("widgets/EditableField/input/InputView",["jscore/core","template!./_input.hbs","styles!./_input.less"],function(e,t,i){"use strict";var l=e.View.extend({getTemplate:function(){return t(this.options)},getStyle:function(){return i},getInput:function(){return this.getElement().find("."+l.EL_INPUT)},getStatusSpan:function(){return this.getElement().find("."+l.EL_STATUS_SPAN)},getErrorSpan:function(){return this.getElement().find("."+l.EL_ERROR_SPAN)},getValue:function(){return this.getInput().getValue()},show:function(){this.getElement().setModifier("show","",l.EL_ROOT)},hide:function(){this.getElement().removeModifier("show")},showSelection:function(){var e=this.getInput();e.focus()}},{EL_ROOT:"elWidgets-EditableField-Input",EL_INPUT:"elWidgets-EditableField-Input-Textbox",EL_ERROR_SPAN:"elWidgets-EditableField-Input-ErrorStatus",EL_STATUS_SPAN:"elWidgets-EditableField-Input-Status"});return l}),define("widgets/EditableField/input/Input",["jscore/core","./InputView"],function(e,t){function i(){var e,t=this.view,i=t.getInput(),l=t.getValue(),n=t.getInput().getAttribute("placeholder"),d=!1;""===l&&""!==n&&(t.getInput().setValue(n),d=!0),i.setStyle("width",0),e=i.getProperty("scrollWidth"),e+=i.getProperty("offsetHeight"),i.setStyle("width",Math.max(e,140)+"px"),d&&t.getInput().setValue("")}return e.Widget.extend({view:function(){return new t(this.options)},onViewReady:function(){this.view.getInput().addEventHandler("input",function(e){i.call(this,e)}.bind(this))},updateSize:function(){i.call(this)},hide:function(){this.view.hide()},getValue:function(){return this.view.getValue()},setValue:function(e){this.view.getInput().setValue(e)},reset:function(e){this.setValue(e)}})}),define("styles!widgets/EditableField/_editablefield.less",function(){return".elWidgets-EditableField {\n  max-width: calc(100% - 2px);\n  padding-bottom: 2px;\n  padding-top: 2px;\n  outline: none;\n  word-wrap: break-word;\n  position: relative;\n  vertical-align: middle;\n  height: 2rem;\n  line-height: 20px;\n  display: inline-block;\n  min-width: 140px;\n  /*\n    * when editable is false\n    **/\n\n  /*\n     * have to reset overflow intial in edit mode\n     * coz focus get hidden with overflow:none on textHolder\n    */\n\n}\n.elWidgets-EditableField-textHolder_defaultValue {\n  font-style: italic;\n  color: #8d8d8d;\n}\n.elWidgets-EditableField-textHolderText {\n  display: block;\n  margin-right: 15px;\n  padding-right: 15px;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  padding-left: 1px;\n  cursor: pointer;\n}\n.elWidgets-EditableField-iconHolderIcon {\n  border-left: 1px solid #ccc;\n  width: 24px;\n  opacity: 0;\n  bottom: 0;\n  height: auto;\n  margin: 0;\n  position: absolute;\n  right: 0;\n  top: 0;\n  cursor: pointer;\n}\n.elWidgets-EditableField:hover:not(.elWidgets-EditableField_editMode):not(.elWidgets-EditableField_status_error),\n.elWidgets-EditableField:focus:not(.elWidgets-EditableField_editMode):not(.elWidgets-EditableField_status_error) {\n  background: #fff;\n  color: #333;\n  border-radius: 2.01px;\n  box-shadow: 0 0 0 1px #ccc;\n}\n.elWidgets-EditableField:hover:not(.elWidgets-EditableField_editMode):not(.elWidgets-EditableField_status_error) .elWidgets-EditableField-iconHolderIcon,\n.elWidgets-EditableField:focus:not(.elWidgets-EditableField_editMode):not(.elWidgets-EditableField_status_error) .elWidgets-EditableField-iconHolderIcon {\n  opacity: 1;\n}\n.elWidgets-EditableField_regular {\n  cursor: default;\n}\n.elWidgets-EditableField_regular .elWidgets-EditableField-textHolder,\n.elWidgets-EditableField_regular .elWidgets-EditableField-textHolderText {\n  cursor: default;\n}\n.elWidgets-EditableField_regular .elWidgets-EditableField-iconHolderIcon {\n  display: none;\n  cursor: default;\n}\n.elWidgets-EditableField_regular:focus,\n.elWidgets-EditableField_regular:hover {\n  box-shadow: none !important;\n}\n.elWidgets-EditableField_editMode .elWidgets-EditableField-textHolder,\n.elWidgets-EditableField_status_error .elWidgets-EditableField-textHolder {\n  overflow: initial;\n}\n.elWidgets-EditableField_editMode .elWidgets-EditableField-textHolderText,\n.elWidgets-EditableField_status_error .elWidgets-EditableField-textHolderText {\n  display: none;\n}\n.elWidgets-EditableField_editMode,\n.elWidgets-EditableField_status_error {\n  display: block;\n  box-shadow: none;\n  left: -2px;\n}\n.elWidgets-EditableField_status_error .elWidgets-EditableField-Input-Textbox {\n  border-color: #e32119;\n}\n.elWidgets-EditableField_status_error .elWidgets-EditableField-Input-Textbox:focus {\n  box-shadow: 0 0 1px 1px #e32119;\n}\n.elWidgets-EditableField_status_warning .elWidgets-EditableField-Input-Textbox:focus {\n  box-shadow: 0 0 1px 1px #f08a00;\n}\n.elWidgets-EditableField_status_warning .elWidgets-EditableField-Input-Textbox {\n  border-color: #f08a00;\n}\n.elWidgets-EditableField_status_ok .elWidgets-EditableField-Input-Textbox:focus {\n  box-shadow: 0 0 1px 1px #89ba17;\n}\n.elWidgets-EditableField_status_ok .elWidgets-EditableField-Input-Textbox {\n  border-color: #89ba17;\n}\n"}),define("template!widgets/EditableField/_editablefield.hbs",["jscore/handlebars/handlebars"],function(e){return e.template(function(e,t,i,l,n){function d(e,t){var l,n,d="";return d+='title="',(n=i.editLabel)?l=n.call(e,{hash:{}}):(n=e&&e.editLabel,l=typeof n===r?n.call(e,{hash:{}}):n),d+=u(l)+'"'}this.compilerInfo=[4,">= 1.0.0"],i=this.merge(i,e.helpers);var a,o,s="",r="function",u=this.escapeExpression,g=this;return s+='<div class="elWidgets-EditableField" tabindex="0" ',a=i.if.call(t,t&&t.editable,{hash:{},inverse:g.noop,fn:g.program(1,d,n)}),(a||0===a)&&(s+=a),s+='>\n\t<span class="elWidgets-EditableField-textHolder" title="',(o=i.value)?a=o.call(t,{hash:{}}):(o=t&&t.value,a=typeof o===r?o.call(t,{hash:{}}):o),s+=u(a)+'">\n\t\t<span class="elWidgets-EditableField-textHolderText">',(o=i.value)?a=o.call(t,{hash:{}}):(o=t&&t.value,a=typeof o===r?o.call(t,{hash:{}}):o),s+=u(a)+'</span>\n\t</span>\n    <span class="elWidgets-EditableField-iconHolder" title="',(o=i.editLabel)?a=o.call(t,{hash:{}}):(o=t&&t.editLabel,a=typeof o===r?o.call(t,{hash:{}}):o),s+=u(a)+'">\n\t\t<i class="elWidgets-EditableField-iconHolderIcon ebIcon ebIcon_medium ebIcon_edit"></i>\n\t</span>\n</div>\n'})}),define("widgets/EditableField/EditableFieldView",["jscore/core","template!./_editablefield.hbs","styles!./_editablefield.less"],function(e,t,i){"use strict";var l=e.View.extend({getTemplate:function(){return t(this.options)},getStyle:function(){return i},getTextHolder:function(){return this.getElement().find("."+l.EL_TEXT_HOLDER)},getRoot:function(){return this.getElement()},getTextSpan:function(){return this.getElement().find("."+l.EL_TEXT)},getText:function(){return this.getTextSpan().getText()},setRootModifier:function(e){var t=this.getRoot();t.setModifier(e,"",l.EL_ROOT)},removeRootModifier:function(e){var t=this.getRoot();t.removeModifier(e,"",l.EL_ROOT)},setText:function(e){var t=this.getTextSpan();t.setText(e)},updateText:function(e,t){e&&t?this.toggleDefaultTextModifier(!0):this.toggleDefaultTextModifier(!1),this.setTitle(e),this.setText(e)},toggleDefaultTextModifier:function(e){var t=this.getTextHolder();e?(t.setModifier("defaultValue","",l.EL_TEXT_HOLDER),this.setTitle(l.CLICK_TO_EDIT)):t.removeModifier("defaultValue","",l.EL_TEXT_HOLDER)},setTitle:function(e){var t=this.getTextHolder();t.setAttribute("title",e)},toggleEditableMode:function(e,t,i){var n=this.getRoot();if(e){var d=n.find("input");n.setModifier("editMode","",l.EL_ROOT),i&&d.getNative().select(),d.focus(),t.updateSize()}else n.removeModifier("editMode")}},{EL_TEXT_HOLDER:"elWidgets-EditableField-textHolder",EL_TEXT:"elWidgets-EditableField-textHolderText",EL_ROOT:"elWidgets-EditableField",CLICK_TO_EDIT:"click to edit"});return l}),define("widgets/EditableField/EditableField",["widgets/WidgetCore","jscore/core","./EditableFieldView","./input/Input","widgets/utils/keyboardUtils","jscore/ext/privateStore"],function(e,t,i,l,n,d){"use strict";function a(){return"block"===this.getElement().find(".elWidgets-EditableField-Input").getStyle("display")}function o(e,t){var i=a.call(this),l=s(this).inputField.getValue();e=void 0!==e?e:!i;var d=this.view;d.toggleEditableMode(e,s(this).inputField,s(this).defaultValue),s(this).defaultValue&&(s(this).defaultValue=!1),!s(this).defaultValue&&""===l&&this.options.hasOwnProperty("placeholder")&&(s(this).defaultValue=!0),e||(t===n.ESCAPE?s(this).inputField.reset(s(this).oldValue):(l=""!==l?l:this.options.placeholder,d.updateText(l,s(this).defaultValue),l=s(this).inputField.getValue(),l!==s(this).oldValue&&(s(this).oldValue=l,this.trigger("change"))))}var s=d.create();return e.extend({view:function(){var e=this.options;return new i({value:e.value,editLabel:e.editIconTooltip||"click to edit"})},init:function(e){this.options=e||{},s(this).editable=void 0===this.options.editable||this.options.editable,s(this).inputField=void 0,s(this).oldValue=this.options.value,s(this).defaultValue=!!this.options.defaultValue},onViewReady:function(){var e=this.options,t=this.view;s(this).inputField=new l(e),s(this).inputField.attachTo(t.getTextHolder());var i=e.hasOwnProperty("value"),d=s(this).defaultValue;d&&!i&&(t.updateText(e.defaultValue,d),s(this).inputField.setValue(e.defaultValue)),d||i||!e.hasOwnProperty("placeholder")||t.updateText(e.placeholder,!0);var r=this.getElement();if(s(this).editable){r.addEventHandler("keyup",function(e){e.originalEvent.keyCode===n.ENTER&&s(this).editable&&o.call(this)}.bind(this)),r.addEventHandler("click",function(e){s(this).editable&&!a.call(this)&&o.call(this)}.bind(this)),t.getTextHolder().addEventHandler("keyup",function(e){var t=e.originalEvent.keyCode;t!==n.ENTER&&t!==n.ESCAPE||o.call(this,!1,t),e.stopPropagation()}.bind(this));var u=s(this).inputField.view.getInput();u.addEventHandler("keydown",function(e){var t=e.originalEvent.keyCode;t===n.TAB&&o.call(this,!1,t),e.stopPropagation()}.bind(this)),u.addEventHandler("blur",function(e){o.call(this,!1),e.stopPropagation()}.bind(this))}else r.setModifier("regular"),r.removeAttribute("tabindex")},getValue:function(){return s(this).inputField.getValue()}})}),define("widgets/EditableField",["widgets/EditableField/EditableField"],function(e){return e});