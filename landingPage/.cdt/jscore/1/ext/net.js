/* Copyright (c) Ericsson 2018 */

define("jscore/ext/net",["jscore/core"],function(e){"use strict";var t={};return t.ajax=function(t){var a,n=new XMLHttpRequest,r=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,o=r.exec(window.location.href.toLowerCase());t=t||{};var s=function(){function a(a){t.error&&t.error.call(null,a.message,new e.XHR(n))}var r=n.responseText,o=n.status;if(t.success){if("json"===t.dataType){if(204!==o&&304!==o)try{r=JSON.parse(r)}catch(e){return void a(e)}}else"xml"===t.dataType&&(r=(new DOMParser).parseFromString(r,"text/xml"));t.success.call(null,r,new e.XHR(n))}},i=function(){t.error&&t.error.call(null,n.statusText,new e.XHR(n))},u=function(){t.onTimeout&&t.onTimeout.call(null,new e.XHR(n))},c=function(e){if("object"==typeof e){var t=[];for(var a in e)t.push(encodeURIComponent(a)+"="+encodeURIComponent(e[a]));return t.join("&")}return e};a={success:s,error:i,onTimeout:u,type:"GET",dataType:"text",url:window.location.host+window.location.pathname,processData:!0};var l=["statusCode","processData","cache","data","contentType","dataType","type","url","headers","withCredentials"];for(var d in t)l.indexOf(d)>-1&&(a[d]=t[d]);void 0===t.timeout||isNaN(parseInt(t.timeout))||(n.timeout=parseInt(t.timeout)),"GET"!==a.type&&void 0!==a.data&&void 0===a.contentType&&(a.headers&&a.headers["Content-Type"]||(a.contentType="application/x-www-form-urlencoded; charset=UTF-8"));var p=function(e){var t=!1;return function(){t||(a.statusCode&&a.statusCode[n.status]&&a.statusCode[n.status](),n.status>=200&&n.status<300||304===n.status?a.success():"timeout"===e?a.onTimeout():a.error(),t=!0)}},f=null;a.processData?"GET"===a.type&&a.data?a.url.indexOf("?")===-1?a.url+="?"+c(a.data):a.url+="&"+c(a.data):"object"==typeof a&&(f=c(a.data)):a.data&&(f=a.data),n.open(a.type,a.url,!0);var v=r.exec(a.url),y=v&&(v[1]!==o[1]||v[2]!==o[2]||v[3]);if(y||n.setRequestHeader("X-Requested-With","XMLHttpRequest"),void 0!==a.withCredentials&&(n.withCredentials=a.withCredentials),a.contentType!==!1&&void 0!==a.contentType&&n.setRequestHeader("Content-Type",a.contentType),a.dataType){var T={json:"application/json, text/javascript, */*; q=0.01",xml:"application/xml, text/xml, */*; q=0.01"};n.setRequestHeader("Accept",T[a.dataType]||"*/*")}for(var w in a.headers)n.setRequestHeader(w,a.headers[w]);return n.onload=p("success"),n.onerror=p("error"),n.ontimeout=p("timeout"),n.send(f),new e.XHR(n)},t.parallel=function(e,a,n,r){var o=0,s=[],i=[],u=[];r=r||{};var c=function(){if(++o>=a.length&&n){if(r.includeErrors!==!0)for(var e=0;e<i.length;e++)u.indexOf(i[e])>-1&&(i.splice(e,1),s.splice(e,1),e--);n(s,i)}};a.forEach(function(a,n){var o,l,d={};for(o in e)d[o]=e[o];for(o in a)d[o]=a[o];var p=d.success;d.success=function(e){p&&p.apply(null,arguments),s[n]=e,i[n]=l,c()};var f=d.error;d.error=function(e){f&&f.apply(null,arguments),s[n]=e,i[n]=l,u.push(l),r.alwaysExecute&&c()},l=t.ajax(d)})},t});